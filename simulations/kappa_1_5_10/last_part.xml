
	<!-- The unique patterns from 1 to end                                       -->
	<!-- npatterns=995                                                           -->
	<patterns id="patterns" from="1">
		<alignment idref="alignment"/>
	</patterns>

	<!-- fixed tree                                       -->
    <newick id="startingTree">
((((('A/Caen/1/84':1.4131703478784239,'A/Oita/3/83':0.4131703478784239):0.9612296842717925,(('A/Texas/12764/83':0.48267547252735277,(((('A/Czechoslovakia/4/86':0.6212308217617775,'A/Memphis/6/86':0.6212308217617775):0.2965133363903192,'A/Leningrad/360/86':0.9177441581520966):0.8436366357802552,(('A/Colorado/2/87':0.7867527778084522,(('A/LosAngeles/87':0.3639165152746884,('A/Guangdong/9/87':0.08120825918249608,'A/Sichuan/2/87':0.08120825918249608):0.2827082560921923):0.27713957691385005,('A/Shanghai/11/87':0.4461166644373957,('A/Victoria/7/87':0.25261367954139224,(('A/Perth/1/92':1.780511210644736,('A/Beijing/32/92':0.7685474375041803,((('A/Sapporo/304/92':0.33021586741227615,(((('A/Thailand/75/94':0.7462065049334328,'A/Singapore/7/94':0.7462065049334328):0.9957396630404141,(((('A/Argentina/3779/94':0.36961427403446834,'A/Johannesburg/33/94':0.36961427403446834):0.23601630604902546,('A/HongKong/1/94':0.4916335987349001,'A/England/67/94':0.4916335987349001):0.1139969813485937):0.15227529984757915,'A/Pennsylvania/7/94':0.757905879931073):0.916064006974354,(('A/Aichi/69/94':0.5341438599780801,'A/Shangdong/5/94':0.5341438599780801):0.07659237017874787,(((((('A/Switzerland/7729/98':0.1892097994694275,('A/JOHANNESBURG/3/98':0.10807527089020397,'A/Seoul/37/98':0.10807527089020397):0.08113452857922354):0.21781643360852776,('A/PERTH/24/98':0.23008461350220877,'A/Neuquen/V541/98':0.23008461350220877):0.1769416195757465):0.5037068261958897,'A/Greece/103/98':0.910733059273845):0.03851238039011662,'A/MALMO/1/98':0.9492454396639616):0.12482505343826844,('A/Pusan/68/98':0.7460180535349963,(('A/Nagasaki/76/98':0.5311257726440157,(('A/Waikato/12/98':0.10791253739161988,'A/Christchurch/45/98':0.10791253739161988):0.2930946270918433,'A/Ushuaia/R127/98':0.4010071644834632):0.13011860816055254):0.10997211501229742,('A/Tucuman/V425/98':0.3830082197941973,'A/Cordoba/V185/98':0.3830082197941973):0.25808966786211585):0.10492016587868314):0.32805243956723373):0.7651845437499283,'A/Athens/1/98':1.8392550368521583):2.7714811933046697):1.063233656748599):0.06797628106841991):0.1347837528354674,('A/Santiago/7198/94':0.9795385411669066,(('A/Vermont/3/94':0.4247199633920147,'A/Akita/1/94':0.4247199633920147):0.20730093345902745,'A/Romania/160/94':0.6320208968510421):0.3475176443158645):0.8971913796424076):0.3380186449715268,'A/Harbin/15/92':0.214748565780841):0.11546730163143515):0.16977913775672526,'A/Tianjin/33/92':0.4999950051690014):0.11723195810539266,(('A/France/1109/94':2.2136627182472637,'A/California/271/92':0.21366271824726368):0.21252293371272035,('A/Qingdao/53/92':0.35223538500175255,('A/Alaska/9/92':0.2696932656030455,'A/Hawaii/3/92':0.2696932656030455):0.08254211939870704):0.07395026695823148):0.19104131131441004):0.15132047422978623):1.0119637731405557):1.1534654064329253,((('A/Finland/205/92':0.21597976415481135,'A/Mexico/3255/94':2.2159797641548113):0.3468521571905949,'A/SouthAustralia/36/92':0.5628319213454063):1.557897555557556,(('A/Umea/1/92':0.4249890417173745,'A/Indonesia/3946/92':0.4249890417173745):0.31863507776795075,('A/Victoria/29/92':0.44822662445004724,'A/Wellington/66/92':0.44822662445004724):0.295397495035278):1.377105357417637):0.813247140174699):2.318637062463731):0.19350298489600348):0.1949394277511427):0.14569668561991378):0.23087340123692712,(('A/Qingdao/10/87':0.4619330413737721,'A/Guizhou/1/87':0.4619330413737721):0.20607324177430542,('A/Sydney/1/87':0.4124064970103891,'A/Tokyo/1275/87':0.4124064970103891):0.2555997861376884):0.3496198958973018):1.7437546148869725):0.6028878917582965,('A/Wellington/4/85':0.946120432062644,'A/Tonga/23/85':0.946120432062644):0.41814825362800434):1.1184067868367045):0.5134151096557265,'A/Alaska/8/84':1.9960905821830792):0.3783094499671371):0.2073538222409006,'A/Texas/17988/84':2.581753854391117):1.6270271827275806,'A/Philippines/2/82':2.2087810371186976):2.5108113063112043,(('A/Baylor1B/83':2.7933910766944763,'A/ChristHospital/231/82':1.7933910766944763):1.1129423860157566,'A/Belgium/2/81':1.9063334627102329):1.813258880719669);    
</newick>

<!--	 Generate a tree model                                                   -->
	<treeModel id="treeModel">
		<newick idref="startingTree"/>
		<rootHeight>
			<parameter id="treeModel.rootHeight"/>
		</rootHeight>
		<nodeHeights internalNodes="true">
			<parameter id="treeModel.internalNodeHeights"/>
		</nodeHeights>
		<nodeHeights internalNodes="true" rootNode="true">
			<parameter id="treeModel.allInternalNodeHeights"/>
		</nodeHeights>
	</treeModel>

	<!-- The strict clock (Uniform rates across branches)                        -->
	<strictClockBranchRates id="branchRates">
		<rate>
			<parameter id="clock.rate" value="1.2E-2" lower="0.0" upper="100.0"/>
		</rate>
	</strictClockBranchRates>

    <!-- Epoch Model -->
	  <frequencyModel id="freqModel" dataType="nucleotide">
                 <frequencies>
                      <parameter id="frequencies" dimension="4" value="0.25 0.25 0.25 0.25"/>
                 </frequencies>
     </frequencyModel>

     <hkyModel id="hky.1">
         <frequencies>
             <frequencyModel idref="freqModel"/>
         </frequencies>
         <kappa>
             <parameter id="kappa.1" value="1.0" lower="0.0" upper="100.0"/>
         </kappa>
     </hkyModel>

     <hkyModel id="hky.2">
         <frequencies>
             <frequencyModel idref="freqModel"/>
         </frequencies>
         <kappa>
             <parameter id="kappa.2" value="1.0" lower="0.0" upper="100.0"/>
         </kappa>
     </hkyModel>
     
     <hkyModel id="hky.3">
         <frequencies>
             <frequencyModel idref="freqModel"/>
         </frequencies>
         <kappa>
             <parameter id="kappa.3" value="1.0" lower="0.0" upper="100.0"/>
         </kappa>
     </hkyModel>
     
<!-- epoch model -->
     <epochBranchModel id="epochModel">

         <epoch id="epoch1" transitionTime="7">
         	<hkyModel idref="hky.1"/> 
         </epoch>

         <epoch id="epoch2" transitionTime="15">
         	<hkyModel idref="hky.2"/> 
         </epoch>

         <hkyModel idref="hky.3"/>

         <treeModel idref="treeModel"/>
     </epochBranchModel>

	<!-- site model                                                              -->
	<siteModel id="siteModel">
		<branchSubstitutionModel> 
             		<beagleSubstitutionEpochModel idref="epochModel"/>
		</branchSubstitutionModel> 
<!--	     <gammaShape gammaCategories="4">-->
<!--			<parameter id="siteModel.alpha" value="0.5" lower="0.0" upper="1000.0"/>-->
<!--		</gammaShape>-->
	</siteModel>

	<!-- Likelihood for tree given sequence data                                 -->
	<treeLikelihood id="treeLikelihood">
        <patterns idref="patterns"/>
		<treeModel idref="treeModel"/>
		<siteModel idref="siteModel"/>
		<beagleSubstitutionEpochModel idref="epochModel"/>	
        <strictClockBranchRates idref="branchRates"/>
	</treeLikelihood>

	<!-- Define operators                                                        -->
	<operators id="operators">
	
		<scaleOperator scaleFactor="0.75" weight="0.1">
			<parameter idref="kappa.1"/>
		</scaleOperator>
		
		<scaleOperator scaleFactor="0.75" weight="0.1">
			<parameter idref="kappa.2"/>
		</scaleOperator>

		<scaleOperator scaleFactor="0.75" weight="0.1">
			<parameter idref="kappa.3"/>
		</scaleOperator>
		
	</operators>

	<!-- Define MCMC                                                             -->
	<mcmc id="mcmc" chainLength="10000000" autoOptimize="true">
		<posterior id="posterior">
			<prior id="prior">
			
				<logNormalPrior mean="1.0" stdev="2" offset="0.0" meanInRealSpace="true">
					<parameter idref="kappa.1"/>
				</logNormalPrior>
				
				<logNormalPrior mean="1.0" stdev="2" offset="0.0" meanInRealSpace="true">
					<parameter idref="kappa.2"/>
				</logNormalPrior>

				<logNormalPrior mean="1.0" stdev="2" offset="0.0" meanInRealSpace="true">
					<parameter idref="kappa.3"/>
				</logNormalPrior>
				
			</prior>
			
			<likelihood id="likelihood">
				<treeLikelihood idref="treeLikelihood"/>
			</likelihood>
			
		</posterior>
		<operators idref="operators"/>

		<!-- write log to screen                                                     -->
		<log id="screenLog" logEvery="5000">
		
			<column label="kappa.1" sf="6" width="12">
				<parameter idref="kappa.1"/>
			</column>
			
			<column label="kappa.2" sf="6" width="12">
				<parameter idref="kappa.2"/>
			</column>

			<column label="kappa.3" sf="6" width="12">
				<parameter idref="kappa.3"/>
			</column>
			
		</log>

		<!-- write log to file                                                       -->
		<log id="fileLog" logEvery="1000" fileName="epoch.log" overwrite="false">
			<parameter idref="kappa.1"/>
			<parameter idref="kappa.2"/>
            <parameter idref="kappa.3"/>
		</log>

	</mcmc>
	
</beast>
